{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-10-05T20:05:24.173898Z", "invocation_id": "cdbcff4a-3185-48dd-8f8f-2e65cc969e4c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T20:03:55.778448Z", "completed_at": "2025-10-05T20:03:55.842404Z"}, {"name": "execute", "started_at": "2025-10-05T20:03:55.844061Z", "completed_at": "2025-10-05T20:05:08.275438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 72.77017211914062, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf8373-0000-376b-0000-00740b0b9551"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nyctlc_dbt.silver_trips_unified", "compiled": true, "compiled_code": "\n\n-- Unifica Yellow y Green y deduplica por trip_hash (mantiene la fila m\u00e1s reciente por ingest_ts)\n\nwith all_trips as (\n    select * from DM_NYCTLC.SILVER_SILVER.stg_trips_yellow\n    union all\n    select * from DM_NYCTLC.SILVER_SILVER.stg_trips_green\n),\n\nwith_zones as (\n    select\n        t.*,\n        zpu.zone_name   as pickup_zone,\n        zpu.borough     as pickup_borough,\n        zdo.zone_name   as dropoff_zone,\n        zdo.borough     as dropoff_borough\n    from all_trips t\n    left join DM_NYCTLC.SILVER_SILVER.stg_taxi_zones zpu on t.pu_location_id = zpu.location_id\n    left join DM_NYCTLC.SILVER_SILVER.stg_taxi_zones zdo on t.do_location_id = zdo.location_id\n),\n\nwith_hash as (\n    select\n        *,\n        md5(concat_ws('|',\n            coalesce(to_varchar(pickup_datetime),''),\n            coalesce(to_varchar(dropoff_datetime),''),\n            coalesce(to_varchar(pu_location_id),''),\n            coalesce(to_varchar(do_location_id),''),\n            coalesce(service_type,'')\n        )) as trip_hash\n    from with_zones\n    where 1=1\n      -- \ud83d\udd12 filtro de fechas v\u00e1lidas (ajusta si quieres otro rango)\n      and pickup_datetime  between '2009-01-01'::timestamp_ntz and '2025-12-31'::timestamp_ntz\n      and dropoff_datetime between '2009-01-01'::timestamp_ntz and '2025-12-31'::timestamp_ntz\n    \n),\n\ndedup as (\n    select\n        *,\n        row_number() over (partition by trip_hash order by ingest_ts desc) as rn\n    from with_hash\n)\n\nselect\n    /* columnas finales */\n    trip_hash,\n    pickup_datetime,\n    dropoff_datetime,\n    passenger_count,\n    trip_distance,\n    rate_code_id,\n    pu_location_id,\n    do_location_id,\n    payment_type_id,\n    fare_amount,\n    tip_amount,\n    total_amount,\n    service_type,\n    pickup_zone,\n    pickup_borough,\n    dropoff_zone,\n    dropoff_borough,\n    run_id, ingest_ts, src_year, src_month, src_file\nfrom dedup\nwhere rn = 1", "relation_name": "DM_NYCTLC.SILVER_SILVER.silver_trips_unified"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T20:05:08.565126Z", "completed_at": "2025-10-05T20:05:08.583902Z"}, {"name": "execute", "started_at": "2025-10-05T20:05:08.585550Z", "completed_at": "2025-10-05T20:05:23.948458Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 15.59745168685913, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf8375-0000-376b-0000-00740b0b9555"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.nyctlc_dbt.fct_trips", "compiled": true, "compiled_code": "\n\n-- Tabla de hechos principal: fct_trips\n-- Granularidad: 1 fila = 1 viaje\n\nselect\n    s.trip_hash,\n    s.pickup_datetime,\n    s.dropoff_datetime,\n    s.service_type,\n    s.passenger_count,\n    s.trip_distance,\n    s.fare_amount,\n    s.tip_amount,\n    s.total_amount,\n    -- Claves for\u00e1neas hacia dimensiones\n    dz1.zone_sk as pu_zone_sk,\n    dz2.zone_sk as do_zone_sk,\n    s.pickup_borough,\n    s.dropoff_borough,\n    s.pickup_zone,\n    s.dropoff_zone,\n    s.rate_code_id,\n    s.payment_type_id\nfrom DM_NYCTLC.SILVER_SILVER.silver_trips_unified s\nleft join DM_NYCTLC.SILVER_GOLD.dim_zone dz1 on dz1.location_id = s.pu_location_id\nleft join DM_NYCTLC.SILVER_GOLD.dim_zone dz2 on dz2.location_id = s.do_location_id", "relation_name": "DM_NYCTLC.SILVER_GOLD.fct_trips"}], "elapsed_time": 93.68219327926636, "args": {"introspect": true, "use_colors_file": true, "partial_parse_file_diff": true, "log_path": "/home/src/dbt/logs", "log_file_max_bytes": 10485760, "quiet": false, "cache_selected_only": false, "favor_state": false, "macro_debugging": false, "project_dir": "/home/src/dbt", "indirect_selection": "eager", "profiles_dir": "/home/src/dbt", "warn_error_options": {"include": [], "exclude": []}, "full_refresh": true, "empty": false, "send_anonymous_usage_stats": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "which": "run", "write_json": true, "invocation_command": "dbt run --select silver_trips_unified fct_trips --full-refresh --project-dir /home/src/dbt --profiles-dir /home/src/dbt", "select": ["silver_trips_unified", "fct_trips"], "exclude": [], "static_parser": true, "partial_parse": true, "printer_width": 80, "vars": {}, "version_check": true, "strict_mode": false, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "show_resource_report": false, "log_format_file": "debug", "print": true, "log_level": "info", "require_resource_names_without_spaces": false, "enable_legacy_logger": false, "use_colors": true, "populate_cache": true}}